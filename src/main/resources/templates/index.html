<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="https://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Book Manager</title>
    <style>
        body { font-family: sans-serif; max-width: 800px; margin: 20px auto; }
        h1 { text-align: center; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        form { margin: 0; display: inline; }
        .add-form { margin-top: 20px; display: flex; gap: 10px; }
        .add-form input[type=text] { flex: 1; padding: 5px; }
        button { padding: 5px 10px; cursor: pointer; }
    </style>
</head>
<body>
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
  <div></div>
  <div>
    <span sec:authorize="isAuthenticated()">
      Ciao, <span sec:authentication="name"></span> ‚Äî <a th:href="@{/logout}">Logout</a>
    </span>
    <span sec:authorize="isAnonymous()">
      <a th:href="@{/oauth2/authorization/google}">Login con Google</a>
    </span>
  </div>
</div>

    <h1>üìö Book Manager</h1>

    <form class="add-form" action="/add" method="post">
  <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <input type="text" name="title" placeholder="Titolo" required>
        <input type="text" name="author" placeholder="Autore" required>
        <button type="submit">‚ûï Aggiungi</button>
    </form>

    <table>
        <thead>
            <tr><th>ID</th><th>Titolo</th><th>Autore</th><th>Azioni</th></tr>
        </thead>
        <tbody>
            <tr th:each="book : ${books}">
                <td th:text="${book.id}"></td>
                <td>
                    <form th:action="@{'/update/' + ${book.id}}" method="post">
  <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                        <input type="text" name="title" th:value="${book.title}" />
                </td>
                <td>
                        <input type="text" name="author" th:value="${book.author}" />
                        <button type="submit">üíæ Salva</button>
                    </form>
                </td>
                <td>
                    <form th:action="@{'/delete/' + ${book.id}}" method="post">
  <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                        <button type="submit">‚ùå Elimina</button>
                    </form>
                </td>
            </tr>
        </tbody>
    </table>
</body>
</html>
